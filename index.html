<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>25-26 Hakuba Snow Trip</title>
    
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="icon.jpg">
    <link rel="icon" href="icon.jpg">
    <link rel="manifest" href="data:application/manifest+json;base64,ewogICJnameIjogIjI1LTI2IEhha3ViYSBTbm93IFRyaXAiLAogICJzaG9ydF9uYW1lIjogIueahOmmrOa7kembqiIsCiAgInN0YXJ0X3VybCI6ICIuIiwKICAiZGlzcGxheSI6ICJzdGFuZGFsb25lIiwKICAiYmFja2dyb3VuZF9jb2xvciI6ICIjZTBmMmZlIiwKICAidGhlbWVfY29sb3IiOiAiIzAyODRjNyIsCiAgImljb25zIjogWwogICAgewogICAgICAic3JjIjogImljb24uanBnIiwKICAgICAgInNpemVzIjogIjUxMng1MTIiLAogICAgICAidHlwZSI6ICJpbWFnZS9qcGVnIgogICAgfQogIF0KfQ==">

    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap');
        
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background: linear-gradient(180deg, #e0f2fe 0%, #f8fafc 100%);
            min-height: 100vh;
            color: #334155;
            -webkit-tap-highlight-color: transparent;
            overscroll-behavior-y: contain;
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.6);
        }

        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        .content-container {
            margin-top: -45px;
            border-top-left-radius: 40px;
            border-top-right-radius: 40px;
            position: relative;
            z-index: 10;
            box-shadow: 0 -10px 30px rgba(0,0,0,0.03);
        }

        .tab-active {
            color: #0284c7;
            background: white;
            box-shadow: 0 4px 15px rgba(2, 132, 199, 0.15);
        }

        .flight-card {
            background: linear-gradient(135deg, #0c4a6e 0%, #0284c7 100%);
            color: white;
        }

        .pdf-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: black;
            z-index: 100;
            display: flex;
            flex-direction: column;
        }

        .pdf-header {
            height: 60px;
            background: rgba(0,0,0,0.9);
            display: flex;
            align-items: center;
            padding: 0 20px;
            color: white;
        }

        /* 動畫 */
        .fade-enter-active, .fade-leave-active { transition: opacity 0.2s; }
        .fade-enter-from, .fade-leave-to { opacity: 0; }
    </style>
</head>
<body>
    <div id="app" class="max-w-md mx-auto relative min-h-screen pb-10">
        
        <header class="relative w-full h-[250px] overflow-hidden">
            <img src="HAKUBA.jpg" alt="Hakuba Header" class="w-full h-full object-cover">
            
            <div class="absolute bottom-16 right-5 flex space-x-3">
                <button @click="currentTab = 'schedule'" :class="{'tab-active': currentTab === 'schedule'}" 
                        class="p-3.5 rounded-full glass-card text-slate-400 transition-all duration-300">
                    <i data-lucide="calendar"></i>
                </button>
                <button @click="currentTab = 'info'" :class="{'tab-active': currentTab === 'info'}" 
                        class="p-3.5 rounded-full glass-card text-slate-400 transition-all duration-300">
                    <i data-lucide="info"></i>
                </button>
            </div>
        </header>

        <main class="content-container bg-[#f8fafc] px-5 pt-10 min-h-[70vh]">
            
            <div v-if="currentTab === 'schedule'">
                <div class="flex overflow-x-auto no-scrollbar space-x-5 mb-8 pb-2">
                    <div v-for="(day, index) in scheduleData" :key="index"
                         @click="selectedDayIndex = index"
                         class="flex-shrink-0 text-center cursor-pointer transition-all duration-300"
                         :class="selectedDayIndex === index ? 'text-sky-600 scale-110' : 'text-slate-400'">
                        <div class="text-[10px] font-bold opacity-80 uppercase">Day {{index + 1}}</div>
                        <div class="text-xl font-bold">{{day.date.split(' ')[1]}}</div>
                    </div>
                </div>

                <div class="space-y-6">
                    <div v-for="(item, idx) in currentDay.events" :key="idx">
                        <div v-if="item.travelTime && item.type !== 'flight'" class="flex items-center justify-center my-5">
                            <div class="h-[1px] bg-slate-200 flex-grow"></div>
                            <div class="mx-3 flex items-center space-x-1 text-slate-400 text-[10px] font-bold tracking-widest bg-slate-100 px-3 py-1 rounded-full uppercase">
                                <i data-lucide="car" class="w-3 h-3"></i>
                                <span>{{item.travelTime}} min</span>
                            </div>
                            <div class="h-[1px] bg-slate-200 flex-grow"></div>
                        </div>

                        <flight-card v-if="item.type === 'flight'" :flight="item"></flight-card>

                        <div v-else class="glass-card rounded-2xl p-5 shadow-sm border-l-4 border-sky-400">
                            <div class="flex justify-between items-start mb-3">
                                <div @click="openNav(item.mapUrl)" class="flex-grow cursor-pointer">
                                    <h3 class="font-bold text-lg text-slate-800">{{item.name}}</h3>
                                    <div class="flex items-center text-sky-500 text-[10px] font-bold mt-1 uppercase tracking-wider">
                                        <i data-lucide="navigation" class="w-3 h-3 mr-1"></i> 點擊導航
                                    </div>
                                </div>
                                <button v-if="item.pdf" @click="openPdfViewer(item.pdf, item.name)" 
                                        class="bg-sky-50 text-sky-600 p-2.5 rounded-xl flex flex-col items-center">
                                    <i data-lucide="map" class="w-5 h-5"></i>
                                    <span class="text-[8px] font-bold mt-1">地圖</span>
                                </button>
                            </div>
                            <p class="text-sm text-slate-500 leading-relaxed">{{item.desc}}</p>
                        </div>
                    </div>
                </div>
            </div>

            <div v-if="currentTab === 'info'" class="space-y-8">
                <section>
                    <h2 class="text-sm font-black text-slate-400 mb-4 tracking-widest uppercase flex items-center">
                        <span class="w-8 h-[1px] bg-slate-300 mr-2"></span> 航班概覽
                    </h2>
                    <div class="space-y-4">
                        <flight-card :flight="flightInfo.dep"></flight-card>
                        <flight-card :flight="flightInfo.ret"></flight-card>
                    </div>
                </section>

                <section>
                    <h2 class="text-sm font-black text-slate-400 mb-4 tracking-widest uppercase flex items-center">
                        <span class="w-8 h-[1px] bg-slate-300 mr-2"></span> 住宿資訊
                    </h2>
                    <div class="glass-card rounded-2xl p-5 border-l-4 border-sky-400 shadow-sm" @click="openNav('https://maps.app.goo.gl/QCCSYTBMsZ1gu51J7')">
                        <div class="font-bold text-xl text-slate-800 mb-2">雪ノ音 (雪の音)</div>
                        <p class="text-sm text-slate-500 mb-3 leading-snug">〒399-9211 長野県北安曇郡白馬村神城1102-1</p>
                        <div class="flex items-center text-slate-600 text-sm font-medium">
                            <i data-lucide="phone" class="w-4 h-4 mr-2 text-sky-500"></i> 080-6862-0930
                        </div>
                    </div>
                </section>

                <section>
                    <h2 class="text-sm font-black text-slate-400 mb-4 tracking-widest uppercase flex items-center">
                        <span class="w-8 h-[1px] bg-slate-300 mr-2"></span> 雪場地圖清單
                    </h2>
                    <div class="grid grid-cols-2 gap-3 pb-10">
                        <div v-for="resort in resortsWithPdf" :key="resort.name" @click="openPdfViewer(resort.pdf, resort.name)"
                             class="glass-card p-4 rounded-xl flex items-center space-x-3 cursor-pointer">
                            <i data-lucide="file-text" class="text-sky-500 w-5 h-5"></i>
                            <span class="text-xs font-bold text-slate-700">{{resort.name}}</span>
                        </div>
                    </div>
                </section>
            </div>
        </main>

        <transition name="fade">
            <div v-if="pdfViewer.show" class="pdf-overlay">
                <div class="pdf-header">
                    <button @click="pdfViewer.show = false" class="mr-4 p-2 bg-white/10 rounded-full">
                        <i data-lucide="arrow-left" class="w-5 h-5 text-white"></i>
                    </button>
                    <span class="font-bold text-sm truncate">{{pdfViewer.title}}</span>
                </div>
                <div class="flex-grow relative bg-slate-900">
                    <iframe :src="pdfViewer.url" class="w-full h-full border-none"></iframe>
                </div>
            </div>
        </transition>
    </div>

    <script>
        const { createApp, ref, computed, onMounted, nextTick, watch } = Vue;

        const FlightCard = {
            props: ['flight'],
            template: `
                <div class="flight-card rounded-2xl p-6 shadow-xl relative overflow-hidden mb-4">
                    <i data-lucide="plane" class="absolute -right-6 -top-6 w-32 h-32 opacity-10"></i>
                    <div class="flex justify-between items-center mb-6 relative z-10">
                        <span class="bg-white/20 px-3 py-1 rounded-full text-[10px] font-bold tracking-widest uppercase">{{flight.label}}</span>
                        <span class="font-bold text-sm tracking-widest">{{flight.flightNo}}</span>
                    </div>
                    <div class="flex justify-between items-center relative z-10">
                        <div class="text-center flex-1">
                            <div class="text-3xl font-bold">{{flight.from}}</div>
                            <div class="text-xs opacity-70 mt-1 font-medium">{{flight.depTime}}</div>
                        </div>
                        <div class="flex flex-col items-center flex-1 px-2">
                            <div class="w-full h-[1px] bg-white/30 relative">
                                <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-sky-500 rounded-full p-1">
                                    <i data-lucide="chevron-right" class="w-2 h-2 text-white"></i>
                                </div>
                            </div>
                            <div class="text-[10px] opacity-60 mt-1">{{flight.duration}}</div>
                        </div>
                        <div class="text-center flex-1">
                            <div class="text-3xl font-bold">{{flight.to}}</div>
                            <div class="text-xs opacity-70 mt-1 font-medium">{{flight.arrTime}}</div>
                        </div>
                    </div>
                </div>
            `,
            mounted() { lucide.createIcons(); }
        };

        createApp({
            components: { 'flight-card': FlightCard },
            setup() {
                const currentTab = ref('schedule');
                const selectedDayIndex = ref(0);
                const pdfViewer = ref({ show: false, url: '', title: '' });

                const flightInfo = {
                    dep: { type: 'flight', label: '去程航班 12/27', from: 'TPE', to: 'NRT', flightNo: 'CI104', depTime: '12:35', arrTime: '16:45', duration: '3h 10m' },
                    ret: { type: 'flight', label: '回程航班 01/06', from: 'NRT', to: 'TPE', flightNo: 'CI109', depTime: '19:30', arrTime: '22:35', duration: '4h 05m' }
                };

                const scheduleData = ref([
                    { date: 'Day1 12/27', events: [flightInfo.dep, { name: '諏訪湖服務區', travelTime: '180', desc: '中途休息點，取車後前往白馬。', mapUrl: 'https://maps.app.goo.gl/849jjQy7gyj5MkMn6' }, { name: '民宿 雪ノ音', travelTime: '90', mapUrl: 'https://maps.app.goo.gl/QCCSYTBMsZ1gu51J7' }] },
                    { date: 'Day2 12/28', events: [{ name: '栂池高原滑雪場', desc: '寬闊雪道暖身適應。', mapUrl: 'https://maps.app.goo.gl/Pt9id5Dv9Lctw8dc9', pdf: '栂池高原 Tsugaike.pdf' }] },
                    { date: 'Day3 12/29', events: [{ name: '岩岳滑雪場', desc: '山頂觀景與溫泉。', mapUrl: 'https://maps.app.goo.gl/WgA8uVeC2vtphE2r6', pdf: '岩岳 Iwatake.pdf' }] },
                    { date: 'Day4 12/30', events: [{ name: '八方尾根滑雪場', desc: '挑戰白馬經典斜面。', mapUrl: 'https://maps.app.goo.gl/wdyAsnXxHfVe758k8', pdf: '八方尾根 Happo-One.pdf' }] },
                    { date: 'Day5 12/31', events: [{ name: '八方尾根滑雪場', desc: '跨年滑雪。', mapUrl: 'https://maps.app.goo.gl/wdyAsnXxHfVe758k8', pdf: '八方尾根 Happo-One.pdf' }] },
                    { date: 'Day6 01/01', events: [{ name: '戶隱神社', travelTime: '60', desc: '新年參拜。', mapUrl: 'https://maps.app.goo.gl/CsefRdxMCQxMoagT9' }] },
                    { date: 'Day7 01/02', events: [{ name: '白馬 Cortina', desc: '粉雪天堂。', mapUrl: 'https://maps.app.goo.gl/aCUvXUJWiHbzy7gQA', pdf: 'Cortina.pdf' }] },
                    { date: 'Day8 01/03', events: [{ name: '白馬 Sanosaka', desc: '青木湖美景。', mapUrl: 'https://maps.app.goo.gl/95KNKrEuZ2o2TpAY6', pdf: 'Sanosaka.pdf' }] },
                    { date: 'Day9 01/04', events: [{ name: '白馬五竜滑雪場', desc: '最後衝刺。', mapUrl: 'https://maps.app.goo.gl/z3o2GnS7CmCjcQjf8', pdf: '五龍47 Goryu_47.pdf' }] },
                    { date: 'Day10 01/05', events: [{ name: '松本城', travelTime: '70', desc: '國寶巡禮。', mapUrl: 'https://maps.app.goo.gl/kdast41spPP7gX1k8' }] },
                    { date: 'Day11 01/06', events: [{ name: '舊輕井澤銀座通', desc: '採買伴手禮。', mapUrl: 'https://maps.app.goo.gl/UkAUa1N664H5HKbD7' }, { ...flightInfo.ret, travelTime: '180' }] }
                ]);

                const resortsWithPdf = [
                    { name: '栂池高原', pdf: '栂池高原 Tsugaike.pdf' }, { name: '岩岳', pdf: '岩岳 Iwatake.pdf' }, { name: '八方尾根', pdf: '八方尾根 Happo-One.pdf' }, { name: 'Cortina', pdf: 'Cortina.pdf' }, { name: 'Sanosaka', pdf: 'Sanosaka.pdf' }, { name: '白馬五龍', pdf: '五龍47 Goryu_47.pdf' }
                ];

                const currentDay = computed(() => scheduleData.value[selectedDayIndex.value]);
                
                // 修正導航按鈕：直接在本頁開啟 Google Map，避免空白頁殘留
                const openNav = (url) => { if (url) window.location.href = url; };
                
                const openPdfViewer = (pdf, title) => {
                    pdfViewer.value = { show: true, url: pdf, title: title };
                    nextTick(() => lucide.createIcons());
                };

                onMounted(() => { lucide.createIcons(); });
                watch([currentTab, selectedDayIndex], () => {
                    nextTick(() => lucide.createIcons());
                });

                return { currentTab, selectedDayIndex, scheduleData, currentDay, openNav, openPdfViewer, resortsWithPdf, flightInfo, pdfViewer };
            }
        }).mount('#app');
    </script>
</body>
</html>

